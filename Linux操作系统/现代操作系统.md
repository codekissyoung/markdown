# 《现代操作系统》

本文是《现代操作系统》第3版的笔记。

## 第1章 引论

计算机`CPU`等硬件存在两种工作模式:

- **内核态**:能访问所有硬件、能使用所有机器指令
- **用户态**:受限制的硬件访问、只能使用部分机器指令

操作系统可以理解为人们编写的工作在内核态的唯一软件，其他所有软件都是基于操作系统提供的功能进行二次开发，工作在用户态。

计算机发展历史:

- 第一代：真空管和穿孔卡片
- 第二代：晶体管和批处理系统（多个程序写在一张磁带上，供计算机依次计算完毕）
- 第三代：集成电路芯片和多道程序设计(**分时系统**出现了，多个程序轮流执行一小段时间，直至完毕)
- 第四代: 个人计算机

计算机硬件:

![计算机硬件](https://img.codekissyoung.com/2019/07/09/bcbcd52e98f37c78c6c724eac98bb7c0.png)

![总线](https://img.codekissyoung.com/2019/07/09/81c8b1c8cc082001d747ea88dc9562d7.png)

启动计算机:

1. 计算机加电后，`BIOS`(`Basic Input Output System`)第一个运行，负责检查`RAM`个数、键盘和其他设备是否正常安装并且响应，接着扫描`ISA`与`PCI`总线并且找出连接到上面的所有设备。
1. 之后`BIOS`读取`CMOS`存储器中的启动列表(硬盘、CD-ROM、USB闪存、软盘等)，按照次序找到第一个存在的设备，从里面加载加载第一个扇区`MBR`，根据`MBR`的指示，加载存储在分区中的操作系统引导程序（比如`grub2`）
1. `grub2`负责读入操作系统
1. 操作系统询问`BIOS`索要各种设备的信息，将各种设备的驱动程序调入内核，然后初始化系统，创建各种守护进程，并启动用户登录程序或`GUI`

系统调用:

```c++
count = read( fd, buffer, nbytes )；
```

![系统调用](https://img.codekissyoung.com/2019/07/10/f3cd3440422709ea581c4a5e284295f1.png)

## 第2章 进程与线程

多道程序设计、分时系统指的是一个意思，都是CPU在一段时间内快速在多个进程间切换，轮流执行。

进程的生命周期:

- 创建`fork`
- 终止:正常退出、出错退出、严重错误、被其他进程杀死

UNIX中，一个进程和它的所有后代共同组成一个**进程组**，键盘产生的信号发送给与键盘关联的进程组中的所有成员，每个进程都可以捕获到这个信号。

每个进程都是独立的实体，有自己的程序计数器和内部状态。
# Linux 扫描

## 主机扫描

### fping

- `fping -As -c3 192.168.1.1 192.168.1.74 192.168.1.20`
- `fping -Aes -c3 -g 101.200.144.0/24` 查看某个网段的所有ip情况

```bash
Usage: fping [options] [targets...]
   -a  显示可ping通的目标
   -A  将目标以ip地址的形式显示
   -c  ping每个目标的次数
   -e 显示返回数据包所费时间
   -f file  read list of targets from a file
   -g 可指定目标的开始和结束IP， 或者提供ip的子网掩码,例如
      fping -g 192.168.1.0 192.168.1.255
      fping -g 192.168.1.0/24
   -s 打印最后的统计数据
   -u 显示不可到达的目标
```

### Hping

- Hping是一个命令行下使用的TCP/IP数据包组装/分析工具，其命令模式很像Unix下的ping命令，但是它不是只能发送ICMP回应请求，它还可以支持TCP、UDP、ICMP和RAW-IP协议，它有一个路由跟踪模式，能够在两个相互包含的通道之间传送文件。Hping常被用于检测网络和主机

## 路由扫描

- 查询一个主机到另一个主机的经过的路由的跳数，以及数据延迟情况

### traceroute

```bash
➜  ~ sudo traceroute -n www.imooc.com     # 默认使用的是 UDP 包探测
traceroute to www.imooc.com (117.121.101.41), 30 hops max, 60 byte packets
 1  192.168.1.1  0.412 ms  0.387 ms  0.474 ms
 2  100.64.0.1  2.877 ms  2.883 ms  2.890 ms
 3  59.38.106.217  2.976 ms  4.156 ms  4.136 ms
 4  183.56.65.38  5.283 ms 183.56.65.46  7.128 ms 183.56.65.26  4.038 ms
 5  202.97.65.61  37.725 ms 202.97.65.101  40.245 ms  40.238 ms
 6  * * *
 7  * * *
 8  220.181.17.122  46.704 ms  46.658 ms  45.458 ms
 9  * * *
10  117.121.99.82  34.239 ms  35.550 ms  34.105 ms
11  * * *
12  * * *

➜  ~ sudo traceroute -T -p80 -n www.imooc.com    # 使用 TCP 包去探测
traceroute to www.imooc.com (117.121.101.41), 30 hops max, 60 byte packets
 1  192.168.1.1  0.349 ms  0.355 ms  0.450 ms
 2  100.64.0.1  3.588 ms  3.594 ms  3.583 ms
 3  * * *
 4  * * *
 5  * * *
 6  220.181.177.70  39.335 ms * 220.181.177.222  39.058 ms
 7  * * *
 8  220.181.17.122  41.121 ms  38.737 ms  38.723 ms
 9  * * *
10  117.121.99.82  34.264 ms  34.250 ms  35.086 ms
11  * * *
12  117.121.101.41  39.074 ms  37.898 ms  37.915 ms

➜  ~ sudo traceroute -In www.imooc.com           # 使用 ICMP 包去探测
traceroute to www.imooc.com (117.121.101.41), 30 hops max, 60 byte packets
 1  192.168.1.1  0.283 ms  0.384 ms  0.489 ms
 2  100.64.0.1  2.278 ms  2.305 ms  2.687 ms
 3  59.38.106.217  2.597 ms  3.358 ms  3.713 ms
 4  183.56.65.46  6.884 ms  6.906 ms  6.934 ms
 5  202.97.65.97  37.570 ms  37.834 ms  38.564 ms
 6  * * *
 7  * * *
 8  220.181.17.122  49.967 ms  49.849 ms  49.212 ms
```

### mtr

- 能测试出主机到每个路由间的连通性

```bash
➜  ~ mtr -r www.imooc.com
Start: 2018-08-15T00:14:50+0800

HOST: cky                         Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- _gateway                   0.0%    10    0.3   0.7   0.3   3.0   0.8
  2.|-- 100.64.0.1                 0.0%    10    1.7   1.7   1.2   2.2   0.3
  3.|-- 237.106.38.59.broad.fs.gd  0.0%    10    1.9   1.9   1.5   2.3   0.2
  4.|-- 183.56.65.82              80.0%    10    2.4   2.3   2.3   2.4   0.0
  5.|-- 202.97.65.205              0.0%    10   34.3  35.2  33.5  37.2   1.4
  6.|-- 220.181.16.58             40.0%    10   33.9  39.4  33.8  65.8  12.9
  7.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
  8.|-- 220.181.17.122             0.0%    10   41.8  53.2  41.8  70.2   7.4
  9.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 10.|-- 117.121.99.82              0.0%    10   34.0  34.0  33.5  34.3   0.3
 11.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
```

## 批量主机服务扫描

### nmap

### ncat
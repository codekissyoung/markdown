# 从汇编看C语言

自从学完Linux下64位汇编语言后，对C的理解更深入了一步，本文记录了我再次看C时的想法。

## C提供的数据类型

![2019-10-16 11-51-56 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/fe87769709239601d145a6d9e46b0bad.png)

对于基本类型，在汇编看来，只有占用字节大小的不同，并无类型信息。对于`name`,它是`char*`类型指针，指向的内容在只读区`.rodata`中，同时也可以得知，name存的就是`.LC0`处的地址。

#### 数组

![2019-10-16 12-21-33 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/dff1159a9a630d3eef13dc747e361ae6.png)

再看数组，其实数组名就是数组首地址，数组元素在全局数据区`.data`。

指针可以修改，而数组名不可修改的原因？

> 指针`name`自身有地址，并且存储的数据是别的数据的地址，而数组名处地址存的就是自己的元素。

从图里，也可以看出使用 指针`name` 和 数组`words` 表示字符串的区别。

#### 枚举

![2019-10-16 12-26-16 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/d6df5802ac638b809e842583fb0d409e.png)

我们定义了一种枚举类型`enum color`,但这个类型只在编译器是有用的，变成汇编代码后，这个类型就消失了，只保留了使用这个类型定义的实体 `r` 和 `b`,而这个两个实体在汇编看来和其他数据类型(比如`int`)定义的实体 没有任何区别。

#### 结构体

![2019-10-16 13-21-38 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/f29af8388db357f58e03f2d131d614f4.png)

#### Union

![2019-10-16 16-31-41 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/54d7bfa532d8db26ac59e1978585982f.png)

如图，`union`中所有的数据成员共用一个空间，同一个时间只能储存其中一个数据成员，所有的数据成员具有相同的起始数据地址，未初始化的数据存于 `.bss`区，`char[30]`到了汇编里成了`32`是为了内存对齐。

#### 位域

![2019-10-16 17-03-51 的屏幕截图.png](https://img.codekissyoung.com/2019/10/16/6b0b474e87243748fd68a374e7f1a231.png)
## 系统硬件构成

### 总线
- 在各个部件中传递信息，每次传递一个字(word),一般设计为与cpu的位数相同，32位的机器中，1 字 = 4 字节

### I/O设备
- 键盘/鼠标/显示器/磁盘

### 主存
- 一个临时存储设备，用于正在执行的程序存放数据
- 物理上来说，是DRAM芯片
- 逻辑上来说，是一个线性的字节数组,每个字节都有一个编号，从0开始

### cpu
- 用于解释执行存储在 主存 中的指令
- PC , 程序计数器,永远指向将运行的那条指令在 主存 中的地址
- cpu工作流程: 解释当前PC的指令，更新PC,解释PC的指令
- ALU 算术/逻辑单元
- 加载：从主存复制数据到寄存器
- 存储: 从寄存器复制数据到主存，覆盖主存中原来的值
- 操作: 复制数据到ALU,ALU做算术操作，结果放其中一个寄存器中
- 跳转: 复制数据到PC中，覆盖原来PC中的值
- DMA: 直接存储器存取技术,数据可以不通过处理器而直接从磁盘到达主存

## 高速缓存至关重要

- 数据从磁盘复制到主存,再从主存复制到处理器，这些复制就是开销，系统设计者应该的目标就是使这些复制操作尽快完成
- 在cpu和内存之间设立高速缓存，作为程序数据的暂时集结区域，能明显提高程序效率,这种高速缓存由SRAM(静态随机访问存储器)的硬件技术实现
## 储存设备形成层次结构


## 操作系统管理硬件

- 防止硬件被应用程序滥用
- 向应用层提供简单一致的接口来控制复杂而又通常混乱的低级硬件设备

## 进程

- 程序运行时，操作系统会提供一种假象: 这个进程独占cpu,主存，IO设备，指令依次运行
- 但实际上，多个进程是轮流执行的，操作系统保持和跟踪进程所有状态信息 (eg.PC的值，寄存器文件的值),当进程切换时，它将上一个进程的状态信息保存，然后执行下一个进程，下一个进程执行一会儿后，切换回上一个进程时，直接用保存好的进程状态信息就能恢复之前的执行状态
- 进程切换也称为上下文切换

## 线程

- 一个进程可以由多个称为线程的执行单元组成
- 每个线程都运行在进程的上下文中，并共享同样的代码和全局数据
- 使用多线程编程，比使用多进程编程来的高效,因为多线程之间的通信比多进程之间更容易共享数据
- 使用线程，我们可以在一个进程中执行多个控制流
- 超线程: 也称作同时多线程,正常cpu大约需要20000个时间周期做不同线程间的转换,而超线程的cpu可以在单个周期的基础上决定要执行哪一个线程。比如说，一个线程必须等到某些数据被装载到高速缓存中，那cpu就可以继续去执行另一个线程，intel core i7 就可以一个核执行两个线程,一个四核的系统实际上可以执行8个线程

### 虚拟存储器

- 虚拟存储器为进程提供了一个假象，即每个进程都在独占内存,每个进程看到的都是一样的存储器,称为虚拟地址空间
- 每个进程看到的虚拟地址空间由准确定义的区组成,每个区都有专门的功能
- 程序代码区:对所有进程来说，代码是从同一固定地址开始
- C全局变量区:紧邻着程序代码区，存储的的是初始化的数据
- 堆:紧邻着全局变量区,可以动态扩展使用的内存,使用malloc申请,free释放
- 共享库:存在虚拟地址空间中间,存放的是c标准库
- 栈:位于用户虚拟地址空间顶层(它的上面是内核虚拟地址空间，是不允许用户操作的),编译器使用它来实现函数调用，函数调用，栈增长，函数返回，栈消退
- 内核虚拟存储器:位于整个虚拟存储器顶部，是为内核保留的，不允许应用程序读写和直接调用内核代码定义的函数


## 文件
- unix/linux 里一切都是文件,包括I/O设备,磁盘,键盘,显示器,网络,而文件不过是字节序列，仅此而已
- 文件向应用程序提供了一个统一的视角，来看待系统中各式各样的设备,例如，处理磁盘文件内容，无需了解具体的磁盘文件，同一个程序就可以在使用不同磁盘技术的不同系统上运行

# 网络
- 网络可视为一个I/O设备,系统将一串字节复制到网络适配器时，数据流经网络到达另一台机器，另一台机器可以读取该数据，并把它复制到自己的主存上

# 计算机系统提供的一些抽象
![计算机系统提供的一些抽象](http://upload-images.jianshu.io/upload_images/1581984-2fbe5f6f3436fcce.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



## BIOS与CMOS

```
cmos 记录计算机硬件信息。bios 是可以修改cmos 的程序，该程序为写死在硬件上，不可修改。
硬件开机，第一个执行的程序便是 bios ，然后再是操作系统的引导程序（MBR：主引导记录，
GRUB：统一引导加载器），然后是操作系统内核，再是内核上的操作系统。
```


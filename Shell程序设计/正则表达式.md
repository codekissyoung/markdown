# 正则表达式

- 它是包含匹配，主要用于文件内容
- 包含匹配的意思是：只要匹配到字符，这一整行都要列出来

## 基本匹配规则

- `^cat` 匹配的是以 c 作为开头第一个字符，接着是一个a,接着是一个t 的行
- `^cat$` 匹配的是以 c 作为开头第一个字符，接着是一个a,接着是一个t,然后结尾的行
- `^$` 匹配的是行开头，然后就是行尾，即空行
- `\<cat\>` 匹配的就是单词`cat`，`\<`表示匹配单词开始位置,`\>`匹配单词结束位置
- `gr[ea]y` 匹配的是 先找到一个g,接着是一个r,接着是一个e或者a,接着是y的行,字符组能且只能匹配一个字符，该字符从字符组里选
- `[0-9a-zA-Z_!.?]` 匹配了一个很大的范围，包括数字，大小写字母以及 _ ? . ！四个字符，在`[]`里面，只有 - 是特殊字符，其他都是普通字符,但是`-`放`[]`开头的话，则是普通字符
- `[^1-6]` 匹配不是 1 到 6 的任意字符
- `.` 匹配任意 单个字符
- `|` 的意思是或，`gr[ea]y`可以使用`gr(e|a)y` 或者 `grey|gray` 来代替
- `^(From|Subject|Date):` 匹配的是，行开头是From 或者Subject或者Date,接着是一个: 。区分`^From|Subject|Date:` 它后面的:只在Date分支里

## 匹配个数

- `colou?r`匹配的是，先找到c,接着是o,接着是l,接着是o,接着是 u? ,接着是r, `u?`表示的是，这里 u 可能有，也可能没有
- `4th|4` 简化为 `4(th)?`,匹配的是，先找到4,然后`(th)?`,即可能接着一个th,也可能什么都不接
- `?` 表示0次或1次匹配，`+`表示1次或多次匹配，`*`表示任意次匹配,当然它们都是量词，修饰前面的匹配字符用的
- `<hr +size *= *[0-9]+ *>` 匹配的是,依次先找到邻着的`<hr`个字符，接着是任意多个空格，再接着是`size`,再接任意个空格，再接着`=`,再接着任意个空格,再接着一个或者多个数字,再接着任意多个空格，再接着`>`
- `<hr( +size *= *[0-9]+)? *>`,使用`()?`将子表达式变成了一个可选项，用以匹配`<hr>` `<hr >`这样的情况

## 反向引用

- 正则在GNU的版本中会支持这一功能,即`()`能够记住它们子表达式匹配到的文本
- 假设这么一个问题: 在一篇文章里要匹配连续出现的两个单词比如`the the`,我们不可能把所有的单词都遍历着匹配一遍,只能采取先匹配到一个单词，然后再测试后面跟着的是不是还是这个单词,`[A-Za-z]+`这个是匹配单词的，`([A-Za-z]+) +\1` 先匹配了一个单词，子表达式记录了这个单词(假设是the),后面接着一个或者多个空格，然后是一个反向引用`\1`,这个反向引用匹配的就是这个单词(the),最后我们再给它加上单词界定符,即`\<([A-Za-z]+) +\1\>`
- `([a-z]+)([0-9]+)\1\2` ，其中`\1`就是引用的第1个子表达式， `\2`引用的就是第二个子表达式
- `egrep`命令是支持反向引用的

## 简记法

```bash
\t 制表符
\n 换行符
\r 回车符
\s 任何空白字符
\S 除 \s 外任何字符
\w 等价[0-9a-zA-Z]
\W 除 \w 外任何字符
\d 等价[0-9]
\D 除 \d 外任何字符
\b 匹配单词起始和结束
```


# 正则表达式

- 正则表达式要区分于shell的通配符匹配
- 普通字符匹配
    ```
    i am codekissyoung
    ```
- 特殊字符匹配
    ```
    . 匹配任何字符
    [chars] 匹配任何给定字符集里面的字符
    [^chars] 匹配给定字符集之外的字符
    ^ 匹配行首
    $ 匹配行尾
    \w 匹配[A-Za-z0=9]
    \s 匹配空白 [\f\t\n\r]
    \d 匹配数组 [0-9]
    | 匹配左边或者右边的任何一个
    (expr) 限定范围，元素成组,从而可以捕获到匹配
    ```

- 数量匹配
    ```
    ? 匹配前面元素的 0 个或者 1个
    * 任意个
    + 1个或者多个
    {n} n 个
    {min,} min 个以上
    {min,max} min 到 max 之间个
    ```
- 示例
    ```
    i am (codekissyoung|caokaiyan)\.
    匹配：i am codekissyoung. 和 i am caokaiyan.
    (i am (codekissyoung|caokaiyan)\.){1,2}
    匹配：i am codekissyoung. 和 i am caokaiyan. 和 i am codekissyoung.i am caokaiyan. 和 i am codekissyoung.i am codekissyoung. 等
    ```

- 捕获
每个`()`里面内容的匹配称为捕获，是实现正则表达式的内部机理，不做过于深入

- 贪心 懒惰 和 灾难性的回溯
简单的说，贪心就是尽量多匹配几个字符，懒惰就是尽量少匹配几个